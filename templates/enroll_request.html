{% extends "base.html" %}

{% block title %}Solicitar Inscripci贸n - {{ course.name }}{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}">Dashboard</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('courses') }}">Cursos</a></li>
                    <li class="breadcrumb-item active">Solicitar Inscripci贸n</li>
                </ol>
            </nav>
            
            <div class="card shadow-lg">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">
                        <i class="bi bi-person-plus"></i> Solicitar Inscripci贸n
                    </h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="course-info-card">
                                <div class="text-center mb-3">
                                    <i class="bi bi-book display-1 text-primary"></i>
                                </div>
                                <h5 class="text-center">{{ course.name }}</h5>
                                <p class="text-muted text-center">{{ course.description[:150] }}{% if course.description|length > 150 %}...{% endif %}</p>
                                <div class="course-details">
                                    <p class="mb-1"><strong>Docente:</strong> {{ course.teacher.full_name or course.teacher.username if course.teacher else 'Sin asignar' }}</p>
                                    <p class="mb-1"><strong>Estado:</strong> 
                                        <span class="badge bg-success">{{ 'Activo' if course.status == 'active' else 'Inactivo' }}</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-8">
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle"></i>
                                <strong>Proceso de Inscripci贸n</strong><br>
                                Tu solicitud ser谩 enviada al administrador para su revisi贸n. Recibir谩s una notificaci贸n una vez que sea procesada.
                            </div>
                            
                            <form method="POST" action="{{ url_for('enroll_course', course_id=course.id) }}" enctype="multipart/form-data">
                                <div class="mb-3">
                                    <label for="whatsapp_number" class="form-label">
                                        <i class="bi bi-whatsapp text-success"></i> 驴Cu谩l es tu n煤mero de WhatsApp? <span class="text-danger">*</span>
                                    </label>
                                    <input type="tel" class="form-control" id="whatsapp_number" name="whatsapp_number" required
                                           placeholder="+51 987 654 321" pattern="[+]?[0-9\s-()]+">
                                    <small class="form-text text-muted">
                                         Incluye el c贸digo de pa铆s. Ejemplo: +51 987654321. Te contactaremos por WhatsApp para confirmar tu inscripci贸n.
                                    </small>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="voucher" class="form-label">
                                        <i class="bi bi-receipt text-primary"></i> Comprobante de Pago (Voucher) <span class="text-danger">*</span>
                                    </label>
                                    <input type="file" class="form-control" id="voucher" name="voucher" accept=".jpg,.jpeg,.png,.pdf" required>
                                    <small class="form-text text-muted">
                                         Sube tu voucher o comprobante de pago (JPG, PNG o PDF). M谩ximo 10MB.
                                    </small>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="message" class="form-label">Mensaje para el Administrador</label>
                                    <textarea class="form-control" id="message" name="message" rows="4" 
                                              placeholder="Por favor, sube tu voucher de pago en el campo de arriba. Si tienes alg煤n problema con el pago, escribeme al 900266810. Tambi茅n puedes contarme por qu茅 te interesa este curso o cualquier informaci贸n adicional..."></textarea>
                                    <small class="form-text text-muted">
                                         Importante: Sube tu comprobante de pago. Si hay problemas, cont谩ctanos al 900266810.
                                    </small>
                                </div>
                                
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="terms" required>
                                        <label class="form-check-label" for="terms">
                                            Confirmo que he le铆do la descripci贸n del curso y estoy comprometido(a) con completarlo.
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="d-grid gap-2">
                                    <button type="submit" class="btn btn-primary btn-lg">
                                        <i class="bi bi-send"></i> Enviar Solicitud de Inscripci贸n
                                    </button>
                                    <a href="{{ url_for('courses') }}" class="btn btn-outline-secondary">
                                        <i class="bi bi-arrow-left"></i> Volver a Cursos
                                    </a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.course-info-card {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.course-details p {
    font-size: 0.9rem;
}
</style>
{% endblock %}